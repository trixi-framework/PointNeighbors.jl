<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · PointNeighbors.jl</title><meta name="title" content="API reference · PointNeighbors.jl"/><meta property="og:title" content="API reference · PointNeighbors.jl"/><meta property="twitter:title" content="API reference · PointNeighbors.jl"/><meta name="description" content="Documentation for PointNeighbors.jl."/><meta property="og:description" content="Documentation for PointNeighbors.jl."/><meta property="twitter:description" content="Documentation for PointNeighbors.jl."/><meta property="og:url" content="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><meta property="twitter:url" content="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><link rel="canonical" href="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PointNeighbors.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API reference</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/PointNeighbors.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.GridNeighborhoodSearch" href="#PointNeighbors.GridNeighborhoodSearch"><code>PointNeighbors.GridNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GridNeighborhoodSearch{NDIMS}(search_radius, n_particles; periodic_box_min_corner=nothing,
                              periodic_box_max_corner=nothing, threaded_nhs_update=true)</code></pre><p>Simple grid-based neighborhood search with uniform search radius. The domain is divided into a regular grid. For each (non-empty) grid cell, a list of particles in this cell is stored. Instead of representing a finite domain by an array of cells, a potentially infinite domain is represented by storing cell lists in a hash table (using Julia&#39;s <code>Dict</code> data structure), indexed by the cell index tuple</p><p class="math-container">\[\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor \right) \quad \text{or} \quad
\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor, \left\lfloor \frac{z}{d} \right\rfloor \right),\]</p><p>where <span>$x, y, z$</span> are the space coordinates and <span>$d$</span> is the search radius.</p><p>To find particles within the search radius around a point, only particles in the neighboring cells are considered.</p><p>See also (Chalela et al., 2021), (Ihmsen et al. 2011, Section 4.4).</p><p>As opposed to (Ihmsen et al. 2011), we do not sort the particles in any way, since not sorting makes our implementation a lot faster (although less parallelizable).</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>:          Number of dimensions.</li><li><code>search_radius</code>:  The uniform search radius.</li><li><code>n_particles</code>:    Total number of particles.</li></ul><p><strong>Keywords</strong></p><ul><li><code>periodic_box_min_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in negative coordinate                               directions.</li><li><code>periodic_box_max_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in positive coordinate                               directions.</li><li><code>threaded_nhs_update=true</code>:              Can be used to deactivate thread parallelization in the neighborhood search update.                               This can be one of the largest sources of variations between simulations                               with different thread numbers due to particle ordering changes.</li></ul><p><strong>References</strong></p><ul><li>M. Chalela, E. Sillero, L. Pereyra, M.A. Garcia, J.B. Cabral, M. Lares, M. Merchán. &quot;GriSPy: A Python package for fixed-radius nearest neighbors search&quot;. In: Astronomy and Computing 34 (2021). <a href="https://doi.org/10.1016/j.ascom.2020.100443">doi: 10.1016/j.ascom.2020.100443</a></li><li>Markus Ihmsen, Nadir Akinci, Markus Becker, Matthias Teschner. &quot;A Parallel SPH Implementation on Multi-Core CPUs&quot;. In: Computer Graphics Forum 30.1 (2011), pages 99–112. <a href="https://doi.org/10.1111/J.1467-8659.2010.01832.X">doi: 10.1111/J.1467-8659.2010.01832.X</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/692a77bdfe57700c3d4868cc623e6335aab66c92/src/nhs_grid.jl#L1-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.TrivialNeighborhoodSearch" href="#PointNeighbors.TrivialNeighborhoodSearch"><code>PointNeighbors.TrivialNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TrivialNeighborhoodSearch{NDIMS}(search_radius, eachparticle)</code></pre><p>Trivial neighborhood search that simply loops over all particles. The search radius still needs to be passed in order to sort out particles outside the search radius in the internal function <code>for_particle_neighbor</code>, but it&#39;s not used in the internal function <code>eachneighbor</code>.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>:          Number of dimensions.</li><li><code>search_radius</code>:  The uniform search radius.</li><li><code>eachparticle</code>:   <code>UnitRange</code> of all particle indices. Usually just <code>1:n_particles</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>periodic_box_min_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in negative coordinate                               directions.</li><li><code>periodic_box_max_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in positive coordinate                               directions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/692a77bdfe57700c3d4868cc623e6335aab66c92/src/nhs_trivial.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(search::AbstractNeighborhoodSearch, x, y)</code></pre><p>Initialize a neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>In general, the purpose of a neighborhood search is to find for one point in <code>x</code> all points in <code>y</code> whose distances to that point are smaller than the search radius. <code>x</code> and <code>y</code> are expected to be matrices, where the <code>i</code>-th column contains the coordinates of point <code>i</code>. Note that <code>x</code> and <code>y</code> can be identical.</p><p>See also <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/692a77bdfe57700c3d4868cc623e6335aab66c92/src/neighborhood_search.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(search::AbstractNeighborhoodSearch, x, y; particles_moving = (true, true))</code></pre><p>Update an already initialized neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>Like <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>, but reusing the existing data structures of the already initialized neighborhood search. When the points only moved a small distance since the last <code>update!</code> or <code>initialize!</code>, this is significantly faster than <code>initialize!</code>.</p><p>Not all implementations support incremental updates. If incremental updates are not possible for an implementation, <code>update!</code> will fall back to a regular <code>initialize!</code>.</p><p>Some neighborhood searches might not need to update when only <code>x</code> changed since the last <code>update!</code> or <code>initialize!</code> and <code>y</code> did not change. Pass <code>particles_moving = (true, false)</code> in this case to avoid unnecessary updates. The first flag in <code>particles_moving</code> indicates if points in <code>x</code> are moving. The second flag indicates if points in <code>y</code> are moving.</p><p>See also <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/692a77bdfe57700c3d4868cc623e6335aab66c92/src/neighborhood_search.jl#L17-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.@threaded-Tuple{Any}" href="#PointNeighbors.@threaded-Tuple{Any}"><code>PointNeighbors.@threaded</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@threaded for ... end</code></pre><p>Semantically the same as <code>Threads.@threads</code> when iterating over a <code>AbstractUnitRange</code> but without guarantee that the underlying implementation uses <code>Threads.@threads</code> or works for more general <code>for</code> loops. In particular, there may be an additional check whether only one thread is used to reduce the overhead of serial execution or the underlying threading capabilities might be provided by other packages such as <a href="https://github.com/JuliaSIMD/Polyester.jl">Polyester.jl</a>.</p><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>This macro does not necessarily work for general <code>for</code> loops. For example, it does not necessarily support general iterables such as <code>eachline(filename)</code>.</p></div></div><p>Some discussion can be found at <a href="https://discourse.julialang.org/t/overhead-of-threads-threads/53964">https://discourse.julialang.org/t/overhead-of-threads-threads/53964</a> and <a href="https://discourse.julialang.org/t/threads-threads-with-one-thread-how-to-remove-the-overhead/58435">https://discourse.julialang.org/t/threads-threads-with-one-thread-how-to-remove-the-overhead/58435</a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/692a77bdfe57700c3d4868cc623e6335aab66c92/src/util.jl#L6-L26">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../authors/">Authors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 5 June 2024 12:46">Wednesday 5 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
