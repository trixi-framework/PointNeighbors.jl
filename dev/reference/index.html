<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · PointNeighbors.jl</title><meta name="title" content="API reference · PointNeighbors.jl"/><meta property="og:title" content="API reference · PointNeighbors.jl"/><meta property="twitter:title" content="API reference · PointNeighbors.jl"/><meta name="description" content="Documentation for PointNeighbors.jl."/><meta property="og:description" content="Documentation for PointNeighbors.jl."/><meta property="twitter:description" content="Documentation for PointNeighbors.jl."/><meta property="og:url" content="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><meta property="twitter:url" content="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><link rel="canonical" href="https://trixi-framework.github.io/PointNeighbors.jl/stable/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PointNeighbors.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API reference</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/PointNeighbors.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.DictionaryCellList" href="#PointNeighbors.DictionaryCellList"><code>PointNeighbors.DictionaryCellList</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DictionaryCellList{NDIMS}()</code></pre><p>A simple cell list implementation where a cell index <code>(i, j)</code> or <code>(i, j, k)</code> is mapped to a <code>Vector{Int}</code> by a <code>Dict</code>. By using a dictionary, which only stores non-empty cells, the domain is potentially infinite.</p><p>This implementation is very simple, but it neither uses an optimized hash function for integer tuples, nor does it use a contiguous memory layout. Consequently, this cell list is not GPU-compatible.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/cell_lists/dictionary.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.FullGridCellList" href="#PointNeighbors.FullGridCellList"><code>PointNeighbors.FullGridCellList</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FullGridCellList(; min_corner, max_corner, search_radius = 0.0,
                 periodicity = false, backend = DynamicVectorOfVectors{Int32},
                 max_points_per_cell = 100)</code></pre><p>A simple cell list implementation where each (empty or non-empty) cell of a rectangular (axis-aligned) domain is assigned a list of points. This cell list only works when all points are inside the specified domain at all times.</p><p>Only set <code>min_corner</code> and <code>max_corner</code> and use the default values for the other arguments to create an empty &quot;template&quot; cell list that can be used to create an empty &quot;template&quot; neighborhood search. See <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a> for more details.</p><p><strong>Keywords</strong></p><ul><li><code>min_corner</code>: Coordinates of the domain corner in negative coordinate directions.</li><li><code>max_corner</code>: Coordinates of the domain corner in positive coordinate directions.</li><li><code>search_radius = 0.0</code>: Search radius of the neighborhood search, which will determine the                        cell size. Use the default of <code>0.0</code> to create a template (see above).</li><li><code>periodicity = false</code>: Set to <code>true</code> when using a <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a> with the                        neighborhood search. When using <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>,                        this option can be ignored an will be set automatically depending                        on the periodicity of the neighborhood search.</li><li><code>backend = DynamicVectorOfVectors{Int32}</code>: Type of the data structure to store the actual   cell lists. Can be<ul><li><code>Vector{Vector{Int32}}</code>: Scattered memory, but very memory-efficient.</li><li><code>DynamicVectorOfVectors{Int32}</code>: Contiguous memory, optimizing cache-hits.</li></ul></li><li><code>max_points_per_cell = 100</code>: Maximum number of points per cell. This will be used to                              allocate the <code>DynamicVectorOfVectors</code>. It is not used with                              the <code>Vector{Vector{Int32}}</code> backend.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/cell_lists/full_grid.jl#L1-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.GridNeighborhoodSearch" href="#PointNeighbors.GridNeighborhoodSearch"><code>PointNeighbors.GridNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GridNeighborhoodSearch{NDIMS}(; search_radius = 0.0, n_points = 0,
                              periodic_box = nothing,
                              cell_list = DictionaryCellList{NDIMS}(),
                              update_strategy = nothing)</code></pre><p>Simple grid-based neighborhood search with uniform search radius. The domain is divided into a regular grid. For each (non-empty) grid cell, a list of points in this cell is stored. Instead of representing a finite domain by an array of cells, a potentially infinite domain is represented by storing cell lists in a hash table (using Julia&#39;s <code>Dict</code> data structure), indexed by the cell index tuple</p><p class="math-container">\[\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor \right) \quad \text{or} \quad
\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor, \left\lfloor \frac{z}{d} \right\rfloor \right),\]</p><p>where <span>$x, y, z$</span> are the space coordinates and <span>$d$</span> is the search radius.</p><p>To find points within the search radius around a position, only points in the neighboring cells are considered.</p><p>See also (Chalela et al., 2021), (Ihmsen et al. 2011, Section 4.4).</p><p>As opposed to (Ihmsen et al. 2011), we do not sort the points in any way, since not sorting makes our implementation a lot faster (although less parallelizable).</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>n_points = 0</code>:           Total number of points. The default of <code>0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li><li><code>cell_list</code>:              The cell list that maps a cell index to a list of points inside                           the cell. By default, a <a href="#PointNeighbors.DictionaryCellList"><code>DictionaryCellList</code></a> is used.</li><li><code>update_strategy = nothing</code>: Strategy to parallelize <code>update!</code>. Available options are:<ul><li><code>nothing</code>: Automatically choose the best available option.</li><li><a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate()</code></a>: This is not available for all cell list implementations,   but is the default when available.</li><li><a href="#PointNeighbors.SemiParallelUpdate"><code>SemiParallelUpdate()</code></a>: This is available for all cell list implementations   and is the default when <a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate</code></a> is not available.</li><li><a href="#PointNeighbors.SerialUpdate"><code>SerialUpdate()</code></a></li></ul></li></ul><p><strong>References</strong></p><ul><li>M. Chalela, E. Sillero, L. Pereyra, M.A. Garcia, J.B. Cabral, M. Lares, M. Merchán. &quot;GriSPy: A Python package for fixed-radius nearest neighbors search&quot;. In: Astronomy and Computing 34 (2021). <a href="https://doi.org/10.1016/j.ascom.2020.100443">doi: 10.1016/j.ascom.2020.100443</a></li><li>Markus Ihmsen, Nadir Akinci, Markus Becker, Matthias Teschner. &quot;A Parallel SPH Implementation on Multi-Core CPUs&quot;. In: Computer Graphics Forum 30.1 (2011), pages 99–112. <a href="https://doi.org/10.1111/J.1467-8659.2010.01832.X">doi: 10.1111/J.1467-8659.2010.01832.X</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_grid.jl#L1-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.ParallelUpdate" href="#PointNeighbors.ParallelUpdate"><code>PointNeighbors.ParallelUpdate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ParallelUpdate()</code></pre><p>Fully parallel update by using atomic operations to avoid race conditions when adding points into the same cell. This is not available for all cell list implementations, but is the default when available.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_grid.jl#L106-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.PeriodicBox" href="#PointNeighbors.PeriodicBox"><code>PointNeighbors.PeriodicBox</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PeriodicBox(; min_corner, max_corner)</code></pre><p>Define a rectangular (axis-aligned) periodic domain.</p><p><strong>Keywords</strong></p><ul><li><code>min_corner</code>: Coordinates of the domain corner in negative coordinate directions.</li><li><code>max_corner</code>: Coordinates of the domain corner in positive coordinate directions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/neighborhood_search.jl#L77-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.PrecomputedNeighborhoodSearch" href="#PointNeighbors.PrecomputedNeighborhoodSearch"><code>PointNeighbors.PrecomputedNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PrecomputedNeighborhoodSearch{NDIMS}(; search_radius = 0.0, n_points = 0,
                                     periodic_box = nothing, update_strategy = nothing)</code></pre><p>Neighborhood search with precomputed neighbor lists. A list of all neighbors is computed for each point during initialization and update. This neighborhood search maximizes the performance of neighbor loops at the cost of a much slower <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p><p>A <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> is used internally to compute the neighbor lists during initialization and update.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>n_points = 0</code>:           Total number of points. The default of <code>0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li><li><code>update_strategy</code>:        Strategy to parallelize <code>update!</code> of the internally used                           <code>GridNeighborhoodSearch</code>. See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a>                           for available options.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_precomputed.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SemiParallelUpdate" href="#PointNeighbors.SemiParallelUpdate"><code>PointNeighbors.SemiParallelUpdate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SemiParallelUpdate()</code></pre><p>Loop over all cells in parallel to mark cells with points that now belong to a different cell. Then, move points of affected cells serially to avoid race conditions. This is available for all cell list implementations and is the default when <a href="#PointNeighbors.ParallelUpdate"><code>ParallelUpdate</code></a> is not available.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_grid.jl#L117-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.SerialUpdate" href="#PointNeighbors.SerialUpdate"><code>PointNeighbors.SerialUpdate</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SerialUpdate()</code></pre><p>Deactivate parallelization in the neighborhood search update. Parallel neighborhood search update can be one of the largest sources of error variations between simulations with different thread numbers due to neighbor ordering changes.</p><p>See <a href="#PointNeighbors.GridNeighborhoodSearch"><code>GridNeighborhoodSearch</code></a> for usage information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_grid.jl#L129-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.TrivialNeighborhoodSearch" href="#PointNeighbors.TrivialNeighborhoodSearch"><code>PointNeighbors.TrivialNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TrivialNeighborhoodSearch{NDIMS}(; search_radius = 0.0, eachpoint = 1:0,
                                 periodic_box = nothing)</code></pre><p>Trivial neighborhood search that simply loops over all points.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>: Number of dimensions.</li></ul><p><strong>Keywords</strong></p><ul><li><code>search_radius = 0.0</code>:    The fixed search radius. The default of <code>0.0</code> is useful together                           with <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>eachpoint = 1:0</code>:        Iterator for all point indices. Usually just <code>1:n_points</code>.                           The default of <code>1:0</code> is useful together with                           <a href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>copy_neighborhood_search</code></a>.</li><li><code>periodic_box = nothing</code>: In order to use a (rectangular) periodic domain, pass a                           <a href="#PointNeighbors.PeriodicBox"><code>PeriodicBox</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/nhs_trivial.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.copy_neighborhood_search-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.copy_neighborhood_search</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copy_neighborhood_search(search::AbstractNeighborhoodSearch, search_radius, n_points;
                         eachpoint = 1:n_points)</code></pre><p>Create a new <strong>uninitialized</strong> neighborhood search of the same type and with the same configuration options as <code>search</code>, but with a different search radius and number of points.</p><p>The <a href="#PointNeighbors.TrivialNeighborhoodSearch"><code>TrivialNeighborhoodSearch</code></a> also requires an iterator <code>eachpoint</code>, which most of the time will be <code>1:n_points</code>. If the <code>TrivialNeighborhoodSearch</code> is never going to be used, the keyword argument <code>eachpoint</code> can be ignored.</p><p>This is useful when a simulation code requires multiple neighborhood searches of the same kind. One can then just pass an empty neighborhood search as a template and use this function inside the simulation code to generate similar neighborhood searches with different search radii and different numbers of points.</p><pre><code class="language-julia hljs"># Template
nhs = GridNeighborhoodSearch{2}()

# Inside the simulation code, generate similar neighborhood searches
nhs1 = copy_neighborhood_search(nhs, 1.0, 100)

# output
GridNeighborhoodSearch{2, Float64, ...}(...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/neighborhood_search.jl#L46-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.foreach_point_neighbor-Union{Tuple{T}, Tuple{T, Any, Any, Any}} where T" href="#PointNeighbors.foreach_point_neighbor-Union{Tuple{T}, Tuple{T, Any, Any, Any}} where T"><code>PointNeighbors.foreach_point_neighbor</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">foreach_point_neighbor(f, system_coords, neighbor_coords, neighborhood_search;
                       points = axes(system_coords, 2), parallel = true)</code></pre><p>Loop for each point in <code>system_coords</code> over all points in <code>neighbor_coords</code> whose distances to that point are smaller than the search radius and execute the function <code>f(i, j, x, y, d)</code>, where</p><ul><li><code>i</code> is the column index of the point in <code>system_coords</code>,</li><li><code>j</code> the column index of the neighbor in <code>neighbor_coords</code>,</li><li><code>x</code> an <code>SVector</code> of the coordinates of the point (<code>system_coords[:, i]</code>),</li><li><code>y</code> an <code>SVector</code> of the coordinates of the neighbor (<code>neighbor_coords[:, j]</code>),</li><li><code>d</code> the distance between <code>x</code> and <code>y</code>.</li></ul><p>The <code>neighborhood_search</code> must have been initialized or updated with <code>system_coords</code> as first coordinate array and <code>neighbor_coords</code> as second coordinate array.</p><p>Note that <code>system_coords</code> and <code>neighbor_coords</code> can be identical.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: The function explained above.</li><li><code>system_coords</code>: A matrix where the <code>i</code>-th column contains the coordinates of point <code>i</code>.</li><li><code>neighbor_coords</code>: A matrix where the <code>j</code>-th column contains the coordinates of point <code>j</code>.</li><li><code>neighborhood_search</code>: A neighborhood search initialized or updated with <code>system_coords</code>                        as first coordinate array and <code>neighbor_coords</code> as second                        coordinate array.</li></ul><p><strong>Keywords</strong></p><ul><li><code>points</code>: Loop over these point indices. By default all columns of <code>system_coords</code>.</li><li><code>parallel=true</code>: Run the outer loop over <code>points</code> thread-parallel.</li></ul><p>See also <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>, <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/neighborhood_search.jl#L100-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(search::AbstractNeighborhoodSearch, x, y)</code></pre><p>Initialize a neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>In general, the purpose of a neighborhood search is to find for one point in <code>x</code> all points in <code>y</code> whose distances to that point are smaller than the search radius. <code>x</code> and <code>y</code> are expected to be matrices, where the <code>i</code>-th column contains the coordinates of point <code>i</code>. Note that <code>x</code> and <code>y</code> can be identical.</p><p>See also <a href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>update!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/neighborhood_search.jl#L5-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}" href="#PointNeighbors.update!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>PointNeighbors.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(search::AbstractNeighborhoodSearch, x, y; points_moving = (true, true))</code></pre><p>Update an already initialized neighborhood search with the two coordinate arrays <code>x</code> and <code>y</code>.</p><p>Like <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>, but reusing the existing data structures of the already initialized neighborhood search. When the points only moved a small distance since the last <code>update!</code> or <code>initialize!</code>, this is significantly faster than <code>initialize!</code>.</p><p>Not all implementations support incremental updates. If incremental updates are not possible for an implementation, <code>update!</code> will fall back to a regular <code>initialize!</code>.</p><p>Some neighborhood searches might not need to update when only <code>x</code> changed since the last <code>update!</code> or <code>initialize!</code> and <code>y</code> did not change. Pass <code>points_moving = (true, false)</code> in this case to avoid unnecessary updates. The first flag in <code>points_moving</code> indicates if points in <code>x</code> are moving. The second flag indicates if points in <code>y</code> are moving.</p><p>See also <a href="#PointNeighbors.initialize!-Tuple{PointNeighbors.AbstractNeighborhoodSearch, Any, Any}"><code>initialize!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/neighborhood_search.jl#L19-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PointNeighbors.@threaded-Tuple{Any, Any}" href="#PointNeighbors.@threaded-Tuple{Any, Any}"><code>PointNeighbors.@threaded</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@threaded x for ... end</code></pre><p>Run either a threaded CPU loop or launch a kernel on the GPU, depending on the type of <code>x</code>. Semantically the same as <code>Threads.@threads</code> when iterating over a <code>AbstractUnitRange</code> but without guarantee that the underlying implementation uses <code>Threads.@threads</code> or works for more general <code>for</code> loops.</p><p>The first argument must either be a <code>KernelAbstractions.Backend</code> or an array from which the backend can be derived to determine if the loop must be run threaded on the CPU or launched as a kernel on the GPU. Passing <code>KernelAbstractions.CPU()</code> will run the GPU kernel on the CPU.</p><p>In particular, the underlying threading capabilities might be provided by other packages such as <a href="https://github.com/JuliaSIMD/Polyester.jl">Polyester.jl</a>.</p><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>This macro does not necessarily work for general <code>for</code> loops. For example, it does not necessarily support general iterables such as <code>eachline(filename)</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/PointNeighbors.jl/blob/bfaabd2ccd77541ec2da12b59db32aed3cfbdfe8/src/util.jl#L25-L44">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../authors/">Authors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 10 July 2024 08:23">Wednesday 10 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
